---
title: Vim 的一些键位知识
date: 2023-12-15 19:00:02
categories:
  - Tutorials
tags:
  - Vim
thumbnail: 'vim-featured-image.webp #8C68B7'
---

用了几年 Vim 有了一些心得，故有此文。

<!-- more -->

从第一次尝试使用 Vim，到现在不管啥环境都要装个 Vim 插件，也差不多有两年多了。正如俗话所说“万事开头难”嘛，我和大多数的 Vim 初学者一样，也遇到了一段别扭且艰难的学习期。不过好在 Vim 已经让我尝到了一些甜头，这最终使我习惯并喜欢上了这套“反人类”的编辑逻辑。所以这一期就来总结一下 Vim 的一些键位知识，也可以当成教程学习学习。

此外关于我个人的使用上，在用 NeoVim、VSCodeVim 以及 IdeaVim，三家都很好用。不过目前我还只打算开源 NeoVim 的配置，有兴趣的可以看看我的配置仓库：[CWorld NVim Config - Github](https://github.com/cworld1/nvim-config)

## 最基础的内容

### 简单的光标移动

首先是最基础的光标移动。你可能会发现基础的上下左右还能用，但请保持习惯，除了编辑模式下一般不要去碰它。

- 上：k
- 下：j
- 左：h
- 右：l

食指作为更加灵活的那个手指，放在下移光标上，能够更频繁敏捷地持续下移光标。

### 简单的开始输入

进入输入模式：

- 向光标位置输入：i (insert mode)
- 向光标后一个字符的位置输入：a (append)
- 从这一行开头位置输入：I (insert at eol)
- 从这一行末尾位置输入：A (append at eol)
- 单独向下创建一行输入：o (open below)
- 单独向上创建一行输入：O (open above)

使用 Esc 退出该模式。

### 编辑器的常见操作

- 删除一个字符：x (delete char)
- 删除前一个字符：X (delete backspace)
- 撤销：u (undo)
- 返回撤销操作：c-r (redo)（意为 Ctrl + r，后同）

### 编辑器的文件基本操作

- 保存：:w

  > 强制保存：:w!

- 退出当前窗口：:q

  > - 强制退出：:q!
  > - 退出所有窗口：:qa

这样的一个字符命令通常能够连在一起，比如：:wq、:qa!。输入完命令后记得按回车执行。

## Vim 进阶功能

### 更方便的光标移动

使用 w (next word) 或者 e (end word) 向后移动一个词语，其中 w 总是会移动到单词开头，e 总是移动到单词结尾。任何标点字符都会作为分割。b (prev word) 则可以以同样的方式前移。注意这个跳转能跨行。

> 大写的对应按键也有奇效，但是一般不用，这里不展开。

此外还有快速上下跳转空行：{ 和 } 。

- 前往行首：0 ("hard" bol)
- 前往行第一个非空字符：^ ("soft" bol)（你也可以用 0 和 w 配合使用达到同样的效果）
- 前往行末：$ (eol)

- 重复执行以便快速移动：数字 + hjkl

  > 默认情况下侧栏的行号总是显示相对的，所以在跳转行时可以看一眼侧栏相对行号快速跳转。大多数 IDE 都支持这个设定。以 Vim 配置为例：
  >
  > ```vim
  > set number relativenumber
  > ```

- 下翻 1/2 页：c-d
- 上翻 1/2 页：c-u
- 下翻 1/1 页：c-f
- 下翻 1/1 页：c-b

- 前往整个内容顶部：gg
- 前往整个内容底部：G

一个很方便的快捷键：

- 将当前编辑行置于视图中间：zz

还有个没啥用的：

- 下滚动一行：c-e
- 上滚动一行：c-y

### 快速地选择内容

进入选择模式：

- 正常选择（Visual）：v

  > 按下时你就已经选择了当前的一个字母。

- 行选择（Visual Line）：V

  > 按下时你就已经选择了该行。

- 块选择（Visual Block）：c-v

使用 Esc 退出该模式。

### 更多样地选择内容

进入选择模式后：

- 选择单词（从光标到下一个符号/空格，包括符号）：w (word)
- 选择当前单词：iw
- 选择当前单词（包括下一个符号/空格）：aw

  > 同理，可将 w 换成别的，比如：
  >
  > - 大写单词 W (WORD)
  > - 以逗号句号感叹号等收尾的句子：s (sentence)
  > - 段落：p (paregraph)
  > - 引号："、'
  > - 括号：[]、() 等。

### 修改内容

仅修改当前光标所在的这一个字符：r (replace mode)

> 进阶玩法：配合选择模式，先选择内容，再使用 r，可以替换选择范围内的所有内容为新字符。

一些必须要配合的命令：

- 修改选择内容并进入 insert 模式：c (change)

  > 可以先选择内容后使用，也可配合选择一起使用，如 ciw、cap、c3j 等。
  > 
  > 修改本行内光标后的所有内容可用 C

- 删除选择内容：d（delete）

  > 使用方法同上，如 diw、cap 等。不过如果是先选择后删除的话，x 也是一样的（Vim 特色之都可以实现）。
  > 
  > 删除本行内光标后的所有内容可用 D

- 复制选择内容：y (yank)

  > 复制本行也可以用 Y

此外还可以重复输入两次以便快速使用，效果为作用于该行整行，相当于 V + 对应命令。目前已知的命令包括：cc、dd、yy。

- 当前位置后面粘贴内容：p (paste after)
- 当前位置前面粘贴内容：P (paste before)

> 通常是你在复制整行后，粘贴时注意粘贴位置在前或后会比较方便。
>
> 当你选择了部分内容时，本次粘贴会覆盖选择内容（当然正常编辑器都是这样）。

注意上述命令在修改、删除、替换粘贴时，均会将作用内容同时复制到你的剪贴板。这个剪贴板是独立于你的操作系统的，你可以通过下面的配置将其连接：

```vim
set clipboard+=unnamed
```

## Vim 深入功能

### 行内跳转

- 跳转到行内下一个字符：f + 跳转字符 (find char)
- 跳转到行内上一个字符：F + 跳转字符 ("back" find ch)
- 跳转到行内下一个字符（但是光标往前挪一个）：r + 跳转字符 (find char)
- 跳转到行内上一个字符（但是光标往后挪一个）：R ("back" find ch)

可配合 c、d、y 命令。使用 ; 可以持续执行上面说的这个跳转操作，只要当前 buffer 没有被关闭就能一直保存跳转字符的记录，随时可用。而 , 则做相反方向的查找。

### 缩进

- 向前缩进：>>
- 向后缩进：<<

也可以执行多次，如 >3>

### 查找替换

- 向后优先查找内容：/ + 对应内容。输入回车后启用查找模式，使用 n (next) 或 N (prev) 跳转所有匹配项。

  > 一些相关的 Vim 配置：
  >
  > ```vim
  > " Vim 会在您输入搜索模式的过程中逐步匹配并高亮显示匹配的文本。
  > set incsearch
  > " 在搜索时忽略大小写
  > set ignorecase
  > " 将搜索匹配的文本高亮显示
  > set hlsearch
  > ```
  >
  > 高亮显示匹配内容当然很棒！但是取消高亮命令 :nohl 就很不方便了。我一般的解决方案是：
  >
  > ```vim
  > nnoremap <Esc> :nohl<CR>
  > ```
  >
  > 将这个命令映射到 Esc 键。

- 向前优先查找内容：? + 对应内容

  > 快速查找或者跳转可以用 # (prev ident) 和 * (next ident)，快速查找该单词在上下文出现的位置。

- 替换内容：：%s/ + 查找内容 + / + 替换内容 + /g

  > 替换可能会有点复杂，嫌弃的话建议多看看插件，有一些比较好的解决方案的。

### Vim 特色实用小功能

- 跳转到指定行：: + 行号

  > 或者使用行号 + gg（Vim 特色之都可以实现）

- 转置字母大小写：~

  > 也可以通过选择以后按 u 改为小写、U 改为大写实现（Vim 特色之都可以实现）
  >
  > 也可以使用 g 这个转置，将 gu、gU 或者 g~ 与选择操作拼接起来。

- 数字自增：c-a

- 多光标：使用 c-v 进入 Visual Block 模式，将光标选中移动到指定位置后：

  - 同时插入：I
  - 同时追加：A
  - 同时编辑：c
  - 同时删除：d 或者 x
  - 同时修改为同一字符：r
  - 数字逐渐自增：先选中数字列，g，然后 c-a

- 合并行，将下一行或者选中行通过空格连接，而不是回车：J (join)

  > 如果你不喜欢空格可以用 gJ 转置。

- 关闭自动换行后的“行内”上下移动光标：gk、gj

### Vim 特色实用大功能

- 标记：m + 自定义字母 (mark)

  之后使用 ` + 自定义字母跳转到标记

- 宏录制：q + 自定义字母 (record macro)

  再按一次 q 结束。之后使用 @ + 自定义字母播放录制的操作宏

## 最后的话

嗯... 文章有亿点长了。如果实在不喜欢记这些东西，并且真的感觉 Vim 很反人类的话，建议停止尝试。适合自己的才是最好的。

最后给一个一图流链接吧，个人感觉这个写的还蛮不错的。

[Graphical vi-vim Cheat Sheet and Tutorial](http://www.viemu.com/a_vi_vim_graphical_cheat_sheet_tutorial.html)

![vi-vim-cheat-sheet](post/vim-key/vi-vim-cheat-sheet.png)
